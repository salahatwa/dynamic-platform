import{a as j}from"./chunk-2I2HCIQQ.js";import"./chunk-NAK5AQJJ.js";import{a as L}from"./chunk-ASCYJVIG.js";import{e as A,g as V}from"./chunk-5CKBWUIT.js";import"./chunk-QRIHUA6I.js";import{Jb as k,Ka as r,La as C,Sa as d,Ya as S,Z as E,cb as m,eb as y,fb as P,ga as g,gb as O,ha as v,hb as t,ia as f,ib as n,ic as T,ja as h,jb as p,kb as b,lb as _,mb as s,wb as o,xb as u,yb as M}from"./chunk-KOA5EEQG.js";function z(i,l){i&1&&(t(0,"div",2),p(1,"div",6),t(2,"h2"),o(3,"Validating invitation..."),n(),t(4,"p"),o(5,"Please wait while we verify your invitation"),n()())}function D(i,l){if(i&1){let e=b();t(0,"div",3),f(),t(1,"svg",7),p(2,"circle",8)(3,"line",9)(4,"line",10),n(),h(),t(5,"h2"),o(6,"Invalid Invitation"),n(),t(7,"p"),o(8),n(),t(9,"button",11),_("click",function(){g(e);let a=s();return v(a.goToLogin())}),o(10,"Go to Login"),n()()}if(i&2){let e=s();r(8),u(e.error())}}function Y(i,l){if(i&1&&(t(0,"span",19),o(1),n()),i&2){let e=l.$implicit;r(),u(e)}}function N(i,l){if(i&1){let e=b();t(0,"div",23)(1,"p",24),o(2,"You already have an account. Please log in to accept this invitation."),n(),t(3,"button",11),_("click",function(){g(e);let a=s(2);return v(a.goToLogin())}),o(4," Log In to Accept "),n()()}}function F(i,l){if(i&1){let e=b();t(0,"div",23)(1,"p",24),o(2,"You need to create an account to accept this invitation."),n(),t(3,"button",11),_("click",function(){g(e);let a=s(2);return v(a.goToRegister())}),o(4," Create Account "),n(),t(5,"p",25),o(6,"Already have an account? "),t(7,"a",26),_("click",function(){g(e);let a=s(2);return v(a.goToLogin())}),o(8,"Log in"),n()()()}}function G(i,l){if(i&1&&(t(0,"div",4)(1,"div",12),f(),t(2,"svg",13),p(3,"path",14)(4,"polyline",15),n()(),h(),t(5,"h2"),o(6,"You're Invited!"),n(),t(7,"p",16)(8,"strong"),o(9),n(),o(10," has invited you to join "),t(11,"strong"),o(12),n()(),t(13,"div",17)(14,"h3"),o(15,"Your Roles:"),n(),t(16,"div",18),P(17,Y,2,1,"span",19,y),n()(),t(19,"div",20),f(),t(20,"svg",21),p(21,"circle",8)(22,"polyline",22),n(),o(23),n(),S(24,N,5,0,"div",23)(25,F,9,0),n()),i&2){let e,c,a,I,w,x=s();r(9),u((e=x.validInvitation())==null?null:e.inviterName),r(3),u((c=x.validInvitation())==null?null:c.corporateName),r(5),O((a=x.validInvitation())==null?null:a.roles),r(6),M(" Expires on ",x.formatDate(((I=x.validInvitation())==null?null:I.expiresAt)||"")," "),r(),m(24,(w=x.validInvitation())!=null&&w.userExists?24:25)}}function R(i,l){if(i&1&&(t(0,"span",19),o(1),n()),i&2){let e=l.$implicit;r(),u(e)}}function B(i,l){if(i&1&&(t(0,"div",27),o(1),n()),i&2){let e=s(2);r(),M(" ",e.acceptError()," ")}}function H(i,l){if(i&1){let e=b();t(0,"div",4)(1,"div",12),f(),t(2,"svg",13),p(3,"path",14)(4,"polyline",15),n()(),h(),t(5,"h2"),o(6,"Accept Invitation"),n(),t(7,"p",16),o(8," You've been invited to join "),t(9,"strong"),o(10),n()(),t(11,"div",17)(12,"h3"),o(13,"You will be assigned these roles:"),n(),t(14,"div",18),P(15,R,2,1,"span",19,y),n()(),S(17,B,2,1,"div",27),t(18,"div",23)(19,"button",11),_("click",function(){g(e);let a=s();return v(a.acceptInvitation())}),o(20," Accept Invitation "),n(),t(21,"button",28),_("click",function(){g(e);let a=s();return v(a.goToDashboard())}),o(22," Cancel "),n()()()}if(i&2){let e,c,a=s();r(10),u((e=a.validInvitation())==null?null:e.corporateName),r(5),O((c=a.validInvitation())==null?null:c.roles),r(2),m(17,a.acceptError()?17:-1)}}function q(i,l){i&1&&(t(0,"div",2),p(1,"div",6),t(2,"h2"),o(3,"Accepting invitation..."),n(),t(4,"p"),o(5,"Please wait while we set up your account"),n()())}function U(i,l){if(i&1&&(t(0,"div",5),f(),t(1,"svg",7),p(2,"path",29)(3,"polyline",30),n(),h(),t(4,"h2"),o(5),n(),t(6,"p"),o(7,"Your invitation has been accepted successfully."),n(),t(8,"p",31),o(9,"Redirecting to dashboard..."),n()()),i&2){let e=s();r(5),M("Welcome to ",e.acceptedCorporateName(),"!")}}var tt=(()=>{class i{constructor(e,c,a,I){this.route=e,this.router=c,this.invitationService=a,this.authService=I,this.token=d(""),this.loading=d(!0),this.accepting=d(!1),this.accepted=d(!1),this.error=d(null),this.acceptError=d(null),this.validInvitation=d(null),this.acceptedCorporateName=d("")}ngOnInit(){if(this.token.set(this.route.snapshot.paramMap.get("token")||""),!this.token()){this.error.set("Invalid invitation link"),this.loading.set(!1);return}this.validateInvitation()}validateInvitation(){this.loading.set(!0),this.error.set(null),this.invitationService.validateInvitation(this.token()).subscribe({next:e=>{e.valid?(this.validInvitation.set(e),this.loading.set(!1)):(this.error.set(e.errorMessage||"Invalid invitation"),this.loading.set(!1))},error:e=>{this.error.set("Failed to validate invitation. Please try again."),this.loading.set(!1),console.error("Error validating invitation:",e)}})}isLoggedIn(){return this.authService.isAuthenticated()}acceptInvitation(){this.accepting.set(!0),this.acceptError.set(null),this.invitationService.acceptInvitation(this.token()).subscribe({next:e=>{this.acceptedCorporateName.set(e.corporateName),this.accepted.set(!0),this.accepting.set(!1),this.authService.refreshUserData(),setTimeout(()=>{this.router.navigate(["/admin/dashboard"])},2e3)},error:e=>{this.acceptError.set(e.error?.error||"Failed to accept invitation"),this.accepting.set(!1),console.error("Error accepting invitation:",e)}})}goToLogin(){this.router.navigate(["/login"],{queryParams:{invitation:this.token()}})}goToRegister(){this.router.navigate(["/register"],{queryParams:{invitation:this.token()}})}goToDashboard(){this.router.navigate(["/admin/dashboard"])}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}static{this.\u0275fac=function(c){return new(c||i)(C(A),C(V),C(j),C(L))}}static{this.\u0275cmp=E({type:i,selectors:[["app-accept-invitation"]],standalone:!0,features:[k],decls:8,vars:6,consts:[[1,"accept-invitation-container"],[1,"accept-invitation-card"],[1,"loading-state"],[1,"error-state"],[1,"invitation-info"],[1,"success-state"],[1,"spinner"],["width","64","height","64","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["cx","12","cy","12","r","10"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],[1,"btn-primary",3,"click"],[1,"icon-success"],["width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"],["points","22,6 12,13 2,6"],[1,"invitation-message"],[1,"roles-info"],[1,"roles-list"],[1,"role-badge"],[1,"expiry-info"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","12 6 12 12 16 14"],[1,"action-section"],[1,"info-text"],[1,"secondary-text"],[3,"click"],[1,"error-message"],[1,"btn-secondary",3,"click"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],[1,"redirect-text"]],template:function(c,a){c&1&&(t(0,"div",0)(1,"div",1),S(2,z,6,0,"div",2)(3,D,11,1,"div",3)(4,G,26,4,"div",4)(5,H,23,2,"div",4)(6,q,6,0,"div",2)(7,U,10,1,"div",5),n()()),c&2&&(r(2),m(2,a.loading()?2:-1),r(),m(3,a.error()?3:-1),r(),m(4,a.validInvitation()&&!a.isLoggedIn()?4:-1),r(),m(5,a.validInvitation()&&a.isLoggedIn()&&!a.accepting()?5:-1),r(),m(6,a.accepting()?6:-1),r(),m(7,a.accepted()?7:-1))},dependencies:[T],styles:[".accept-invitation-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);padding:2rem}.accept-invitation-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 20px 60px #0000004d;max-width:500px;width:100%;padding:3rem}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%], .success-state[_ngcontent-%COMP%]{text-align:center}.loading-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .success-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:1.5rem}.error-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#dc2626}.success-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#16a34a}.spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #e5e7eb;border-top-color:#6366f1;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin:0 auto 1.5rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}h2[_ngcontent-%COMP%]{margin:0 0 .75rem;font-size:1.75rem;color:#1a1a1a}p[_ngcontent-%COMP%]{margin:0 0 1rem;color:#666;line-height:1.6}.invitation-info[_ngcontent-%COMP%]{text-align:center}.icon-success[_ngcontent-%COMP%]{width:80px;height:80px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1.5rem}.icon-success[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#fff}.invitation-message[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:2rem}.roles-info[_ngcontent-%COMP%]{background:#f9fafb;padding:1.5rem;border-radius:8px;margin-bottom:1.5rem}.roles-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1rem;color:#374151}.roles-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center}.role-badge[_ngcontent-%COMP%]{background:#6366f1;color:#fff;padding:.5rem 1rem;border-radius:20px;font-size:.9rem;font-weight:500}.expiry-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;color:#666;font-size:.9rem;margin-bottom:2rem}.action-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.info-text[_ngcontent-%COMP%]{color:#374151;font-size:.95rem}.secondary-text[_ngcontent-%COMP%]{color:#666;font-size:.9rem}.secondary-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#6366f1;cursor:pointer;text-decoration:none;font-weight:500}.secondary-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:.875rem 1.5rem;border:none;border-radius:8px;font-weight:600;font-size:1rem;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}.error-message[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b;padding:1rem;border-radius:8px;font-size:.9rem;margin-bottom:1rem}.redirect-text[_ngcontent-%COMP%]{color:#6366f1;font-weight:500;margin-top:1rem}"]})}}return i})();export{tt as AcceptInvitationComponent};
