<div class="app-config-management">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="page-title">
          <svg width="28" height="28" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          {{ 'appConfig.title' | translate }}
        </h1>
        <p class="page-subtitle" *ngIf="selectedApp()">
          {{ 'appConfig.subtitlePrefix' | translate }} "{{ selectedApp()!.name }}"
        </p>
        <p class="page-subtitle" *ngIf="!selectedApp()">
          {{ 'appConfig.selectAppPrompt' | translate }}
        </p>
      </div>

      <div class="header-actions" *ngIf="selectedApp()">
        <button class="btn btn-secondary" (click)="openGroupModal()">
          <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
          </svg>
          {{ 'appConfig.actions.createGroupPrefix' | translate }} "{{ selectedApp()!.name }}"
        </button>
       
        <button class="btn btn-primary" (click)="openConfigModal()">
          <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>
          {{ 'appConfig.actions.createConfigPrefix' | translate }} "{{ selectedApp()!.name }}"
        </button>
      </div>
    </div>
  </div>

  <!-- No App Selected State -->
  <div class="no-app-state" *ngIf="!selectedApp() && hasApps()">
    <div class="empty-state-content">
      <div class="empty-illustration">
        <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <defs>
            <linearGradient id="iconGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color: var(--primary); stop-opacity: 0.1" />
              <stop offset="100%" style="stop-color: var(--secondary); stop-opacity: 0.1" />
            </linearGradient>
          </defs>
          <circle cx="12" cy="12" r="10" fill="url(#iconGradient)" stroke="none" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
            d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
            style="stroke: var(--primary)" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" style="stroke: var(--primary)" />
        </svg>
      </div>
      <h3>{{ 'appConfig.noApp.selectAppTitle' | translate }}</h3>
      <p>{{ 'appConfig.noApp.selectAppDesc' | translate }}</p>
    </div>
  </div>

  <!-- No Apps State -->
  <div class="no-apps-state" *ngIf="!hasApps()">
    <div class="empty-state-content">
      <div class="empty-illustration">
        <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <defs>
            <linearGradient id="iconGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color: var(--primary); stop-opacity: 0.1" />
              <stop offset="100%" style="stop-color: var(--secondary); stop-opacity: 0.1" />
            </linearGradient>
          </defs>
          <circle cx="12" cy="12" r="10" fill="url(#iconGradient)" stroke="none" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
            d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
            style="stroke: var(--primary)" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" style="stroke: var(--primary)" />
        </svg>
      </div>
      <h3>{{ 'appConfig.noApps.welcomeTitle' | translate }}</h3>
      <p>{{ 'appConfig.noApps.welcomeDesc' | translate }}</p>
      <div class="empty-actions">
        <a href="/admin/apps/create" class="btn btn-primary btn-lg">
          <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>
          {{ 'appConfig.noApps.createNewApp' | translate }}
        </a>
      </div>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="filters-section" *ngIf="selectedApp()">
    <div class="filters-container">
      <!-- Search -->
      <div class="search-box">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <input type="text" [placeholder]="('appConfig.filters.searchPlaceholder' | translate)" [value]="searchQuery()"
          (input)="searchQuery.set($any($event.target).value); onSearch()" class="search-input">
      </div>

      <!-- Group Filter Dropdown -->
      <div class="filter-dropdown">
        <button class="dropdown-toggle" (click)="toggleGroupDropdown()">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
          </svg>
          <span>{{ selectedGroup() ? getSelectedGroupName() : ('appConfig.filters.allGroups' | translate) }}</span>
          <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd"
              d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
              clip-rule="evenodd" />
          </svg>
        </button>
        @if (showGroupDropdown()) {
        <div class="dropdown-menu">
          <div class="dropdown-item" (click)="selectGroup(undefined)">
            <span>{{ 'appConfig.filters.allGroups' | translate }}</span>
            @if (!selectedGroup()) {
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                clip-rule="evenodd" />
            </svg>
            }
          </div>
          @for (group of filteredGroups(); track group.id) {
          <div class="dropdown-item" (click)="selectGroup(group.id)">
            <span>{{ group.groupName }}</span>
            @if (selectedGroup() === group.id) {
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                clip-rule="evenodd" />
            </svg>
            }
          </div>
          }
        </div>
        }
      </div>

      <!-- Type Filter Dropdown -->
      <div class="filter-dropdown">
        <button class="dropdown-toggle" (click)="toggleTypeDropdown()">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
          </svg>
          <span>{{ selectedType() || ('appConfig.filters.allTypes' | translate) }}</span>
          <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd"
              d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
              clip-rule="evenodd" />
          </svg>
        </button>
        @if (showTypeDropdown()) {
        <div class="dropdown-menu">
          <div class="dropdown-item" (click)="selectType('')">
            <span>{{ 'appConfig.filters.allTypes' | translate }}</span>
            @if (!selectedType()) {
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                clip-rule="evenodd" />
            </svg>
            }
          </div>
          @for (type of configTypes; track type) {
          <div class="dropdown-item" (click)="selectType(type)">
            <span>{{ getTypeIcon(type) }} {{ type }}</span>
            @if (selectedType() === type) {
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd"
                d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                clip-rule="evenodd" />
            </svg>
            }
          </div>
          }
        </div>
        }
      </div>

      <!-- Active Filter -->
      <label class="checkbox-filter">
        <input type="checkbox" [checked]="showActiveOnly()"
          (change)="showActiveOnly.set(!showActiveOnly()); loadConfigs()">
        <span class="checkbox-custom"></span>
        <span class="checkbox-label">{{ 'appConfig.filters.activeOnly' | translate }}</span>
      </label>

      <!-- View Toggle -->
      <div class="view-toggle">
        <button class="view-btn" [class.active]="activeView() === 'grid'" (click)="activeView.set('grid')"
          [attr.title]="('appConfig.filters.gridView' | translate)">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M10 3H3v7h7V3zM21 3h-7v7h7V3zM21 14h-7v7h7v-7zM10 14H3v7h7v-7z" />
          </svg>
        </button>
        <button class="view-btn" [class.active]="activeView() === 'list'" (click)="activeView.set('list')"
          [attr.title]="('appConfig.filters.listView' | translate)">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content (only show when app is selected) -->
  <div *ngIf="selectedApp()">
    <!-- Loading State -->
    @if (loading()) {
  <div class="loading-state">
    <div class="spinner"></div>
    <p>{{ 'appConfig.loading' | translate }}</p>
  </div>
  }

  <!-- Empty State -->
  @if (!loading() && filteredConfigs().length === 0) {
  <div class="empty-state">
    <div class="empty-illustration">
      <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
          d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
    </div>
    <h3>{{ 'appConfig.empty.title' | translate }}</h3>
    <p>{{ 'appConfig.empty.desc' | translate }}</p>
    <button class="btn btn-primary" (click)="openConfigModal()">{{ 'appConfig.empty.createFirst' | translate }}</button>
  </div>
  }

  <!-- Grid View -->
  @if (!loading() && filteredConfigs().length > 0 && activeView() === 'grid') {
  <div class="config-grid">
    @for (config of filteredConfigs(); track config.id) {
    <div class="config-card" [class.inactive]="!config.active">
      <div class="card-header">
        <div class="card-type-badge" [style.background-color]="getTypeColor(config.configType)">
          {{ getTypeIcon(config.configType) }} {{ config.configType }}
        </div>
        <div class="card-actions" (click)="$event.stopPropagation()">
          <button class="icon-btn" (click)="viewDetails(config)" [attr.title]="('appConfig.card.actions.details' | translate)">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </button>
          <button class="icon-btn" (click)="openConfigModal(config)" [attr.title]="('appConfig.card.actions.edit' | translate)">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
          </button>
          <button class="icon-btn" (click)="duplicateConfig(config)" [attr.title]="('appConfig.card.actions.duplicate' | translate)">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
            </svg>
          </button>
          <button class="icon-btn danger" (click)="confirmDeleteConfig(config)" [attr.title]="('appConfig.card.actions.delete' | translate)">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
          </button>
        </div>
      </div>
      <div class="card-body">
        <div class="card-key">{{ config.configKey }}</div>
        <div class="card-name">{{ config.configName }}</div>
        @if (config.description) {
        <div class="card-description">{{ config.description }}</div>
        }
        <div class="card-value">
          @if (config.configType === ConfigType.BOOLEAN) {
          <span class="value-badge" [class.true]="config.configValue === 'true'">
            {{ config.configValue === 'true' ? ('✓ ' + ('appConfig.card.trueLabel' | translate)) : ('✗ ' + ('appConfig.card.falseLabel' | translate)) }}
          </span>
          } @else {
          <span class="value-text">{{ config.configValue || config.defaultValue || ('appConfig.card.notSet' | translate) }}</span>
          }
        </div>
        <div class="card-meta">
          <span class="meta-item">
            <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" />
            </svg>
            {{ config.appName }}
          </span>
          @if (config.groupName) {
          <span class="meta-item">
            <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
            </svg>
            {{ config.groupName }}
          </span>
          }
          @if (config.isPublic) {
          <span class="meta-item public">
            <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            {{ 'appConfig.card.public' | translate }}
          </span>
          }
          <span class="meta-item">
            <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            v{{ config.version }}
          </span>
        </div>
      </div>
    </div>
    }
  </div>
  }

  <!-- List View -->
  @if (!loading() && filteredConfigs().length > 0 && activeView() === 'list') {
  <div class="config-table-container">
    <table class="config-table">
      <thead>
        <tr>
          <th>{{ 'appConfig.table.type' | translate }}</th>
          <th>{{ 'appConfig.table.key' | translate }}</th>
          <th>{{ 'appConfig.table.name' | translate }}</th>
          <th>{{ 'appConfig.table.value' | translate }}</th>
          <th>{{ 'appConfig.table.app' | translate }}</th>
          <th>{{ 'appConfig.table.group' | translate }}</th>
          <th>{{ 'appConfig.table.status' | translate }}</th>
          <th>{{ 'appConfig.table.version' | translate }}</th>
          <th>{{ 'appConfig.table.actions' | translate }}</th>
        </tr>
      </thead>
      <tbody>
        @for (config of filteredConfigs(); track config.id) {
        <tr [class.inactive]="!config.active">
          <td>
            <span class="type-badge" [style.background-color]="getTypeColor(config.configType)">
              {{ getTypeIcon(config.configType) }}
            </span>
          </td>
          <td><strong>{{ config.configKey }}</strong></td>
          <td>{{ config.configName }}</td>
          <td>
            @if (config.configType === ConfigType.BOOLEAN) {
            <span class="value-badge" [class.true]="config.configValue === 'true'">
              {{ config.configValue === 'true' ? '✓' : '✗' }}
            </span>
            } @else {
            <span class="value-text">{{ config.configValue || config.defaultValue || '-' }}</span>
            }
          </td>
          <td>{{ config.appName }}</td>
          <td>{{ config.groupName || '-' }}</td>
          <td>
            <span class="status-badge" [class.active]="config.active">
              {{ config.active ? ('appConfig.status.active' | translate) : ('appConfig.status.inactive' | translate) }}
            </span>
            @if (config.isPublic) {
            <span class="status-badge public">{{ 'appConfig.status.public' | translate }}</span>
            }
          </td>
          <td>v{{ config.version }}</td>
          <td class="actions-cell" (click)="$event.stopPropagation()">
            <button class="icon-btn" (click)="viewDetails(config)" [attr.title]="('appConfig.card.actions.details' | translate)">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </button>
            <button class="icon-btn" (click)="openConfigModal(config)" [attr.title]="('appConfig.card.actions.edit' | translate)">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
              </svg>
            </button>
            <button class="icon-btn" (click)="duplicateConfig(config)" [attr.title]="('appConfig.card.actions.duplicate' | translate)">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
              </svg>
            </button>
            <button class="icon-btn danger" (click)="confirmDeleteConfig(config)" [attr.title]="('appConfig.card.actions.delete' | translate)">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
            </button>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
  }

  <!-- Pagination -->
  @if (!loading() && filteredConfigs().length > 0 && totalPages() > 1) {
  <div class="pagination-container">
    <div class="pagination-info">
      {{ 'appConfig.pagination.showing' | translate }} {{ (currentPage() * pageSize()) + 1 }} {{ 'appConfig.pagination.to' | translate }} {{ Math.min((currentPage() + 1) * pageSize(), totalElements()) }} {{ 'appConfig.pagination.of' | translate }} {{ totalElements() }} {{ 'appConfig.pagination.configurationsWord' | translate }}
    </div>
    <div class="pagination-controls">
      <button class="btn btn-sm btn-secondary" [disabled]="currentPage() === 0" (click)="previousPage()">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        {{ 'common.previous' | translate }}
      </button>
      
      <div class="page-numbers">
        @for (page of [].constructor(totalPages()); track $index) {
        <button class="page-btn" [class.active]="currentPage() === $index" (click)="goToPage($index)">
          {{ $index + 1 }}
        </button>
        }
      </div>
      
      <button class="btn btn-sm btn-secondary" [disabled]="currentPage() >= totalPages() - 1" (click)="nextPage()">
        {{ 'common.next' | translate }}
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
    </div>
  </div>
  }

  <!-- Config Modal -->
  @if (showConfigModal()) {
  <div class="modal-overlay" (click)="closeModal('config')">
    <div class="modal-content modal-lg" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ configId() ? ('appConfig.modal.config.editTitle' | translate) : (('appConfig.modal.config.createPrefix' | translate) + ' "' + (selectedApp()?.name || '') + '"') }}</h2>
        <button class="btn-close" (click)="closeModal('config')">×</button>
      </div>
      <div class="modal-body">
        <div class="form-row">
          <div class="form-group">
            <label>{{ 'appConfig.modal.config.configKeyLabel' | translate }}</label>
            <input type="text" class="form-control" [value]="configKey()"
              (input)="configKey.set($any($event.target).value)" [disabled]="!!configId()"
              [placeholder]="('appConfig.modal.config.configKeyPlaceholder' | translate)">
            <small class="form-text">{{ 'appConfig.modal.config.configKeyHelp' | translate }}</small>
          </div>

          <div class="form-group">
            <label>{{ 'appConfig.modal.config.configNameLabel' | translate }}</label>
            <input type="text" class="form-control" [value]="configName()"
              (input)="configName.set($any($event.target).value)" [placeholder]="('appConfig.modal.config.configNamePlaceholder' | translate)">
            <small class="form-text">{{ 'appConfig.modal.config.configNameHelp' | translate }}</small>
          </div>
        </div>

        <div class="form-group">
          <label>{{ 'appConfig.modal.config.descriptionLabel' | translate }}</label>
          <textarea class="form-control" rows="2" [value]="configDescription()"
            (input)="configDescription.set($any($event.target).value)"
            [placeholder]="('appConfig.modal.config.descriptionPlaceholder' | translate)"></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>{{ 'appConfig.modal.config.typeLabel' | translate }}</label>
            <select class="form-control" [value]="configType()" (change)="configType.set($any($event.target).value)">
              @for (type of configTypes; track type) {
              <option [value]="type">{{ getTypeIcon(type) }} {{ type }}</option>
              }
            </select>
          </div>


        </div>

        <div class="form-row">
          <div class="form-group">
            <label>{{ 'appConfig.modal.config.configValueLabel' | translate }}</label>
            @if (configType() === ConfigType.BOOLEAN) {
            <select class="form-control" [value]="configValue()" (change)="configValue.set($any($event.target).value)">
              <option value="true">{{ 'appConfig.card.trueLabel' | translate }}</option>
              <option value="false">{{ 'appConfig.card.falseLabel' | translate }}</option>
            </select>
            } @else if (configType() === ConfigType.NUMBER) {
            <input type="number" class="form-control" [value]="configValue()"
              (input)="configValue.set($any($event.target).value)" [placeholder]="('appConfig.modal.config.numberPlaceholder' | translate)">
            } @else if (configType() === ConfigType.JSON || configType() === ConfigType.TEMPLATE) {
            <textarea class="form-control" rows="4" [value]="configValue()"
              (input)="configValue.set($any($event.target).value)"
              [placeholder]="('appConfig.modal.config.jsonTemplatePlaceholder' | translate)"></textarea>
            } @else {
            <input type="text" class="form-control" [value]="configValue()"
              (input)="configValue.set($any($event.target).value)" [placeholder]="('appConfig.modal.config.textPlaceholder' | translate)">
            }
          </div>

          <div class="form-group">
            <label>{{ 'appConfig.modal.config.defaultValueLabel' | translate }}</label>
            <input type="text" class="form-control" [value]="defaultValue()"
              (input)="defaultValue.set($any($event.target).value)" [placeholder]="('appConfig.modal.config.defaultValuePlaceholder' | translate)">
          </div>
        </div>

        @if (configType() === ConfigType.ENUM) {
        <div class="form-group">
          <label>{{ 'appConfig.modal.config.enumValuesLabel' | translate }}</label>
          <input type="text" class="form-control" [value]="enumValues()"
            (input)="enumValues.set($any($event.target).value)" [placeholder]="('appConfig.modal.config.enumValuesPlaceholder' | translate)">
          <small class="form-text">{{ 'appConfig.modal.config.enumValuesHelp' | translate }}</small>
        </div>
        }

        <div class="form-row">
          <div class="form-group">
            <label>{{ 'appConfig.modal.config.groupLabel' | translate }}</label>
            <select class="form-control" [value]="groupId() || ''"
              (change)="groupId.set($any($event.target).value ? +$any($event.target).value : undefined)">
              <option value="">{{ 'appConfig.modal.config.noGroup' | translate }}</option>
              @for (group of filteredGroups(); track group.id) {
              <option [value]="group.id">{{ group.groupName }}</option>
              }
            </select>
          </div>

          <div class="form-group">
            <label>{{ 'appConfig.modal.config.displayOrderLabel' | translate }}</label>
            <input type="number" class="form-control" [value]="displayOrder()"
              (input)="displayOrder.set(+$any($event.target).value)" placeholder="0">
          </div>
        </div>

        <div class="form-group">
          <label>{{ 'appConfig.modal.config.validationRulesLabel' | translate }}</label>
          <input type="text" class="form-control" [value]="validationRules()"
            (input)="validationRules.set($any($event.target).value)" [placeholder]="('appConfig.modal.config.validationRulesPlaceholder' | translate)">
          <small class="form-text">{{ 'appConfig.modal.config.validationRulesHelp' | translate }}</small>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" [checked]="isPublic()" (change)="isPublic.set(!isPublic())">
              <span>{{ 'appConfig.modal.config.publicDesc' | translate }}</span>
            </label>
          </div>

          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" [checked]="isRequired()" (change)="isRequired.set(!isRequired())">
              <span>{{ 'appConfig.modal.config.requiredDesc' | translate }}</span>
            </label>
          </div>

          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" [checked]="active()" (change)="active.set(!active())">
              <span>{{ 'appConfig.modal.config.activeLabel' | translate }}</span>
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal('config')">{{ 'common.cancel' | translate }}</button>
        <button class="btn btn-primary" (click)="saveConfig()" [disabled]="saving()">
          @if (saving()) {
          <span class="spinner-sm"></span>
          }
          {{ configId() ? ('common.update' | translate) : ('common.create' | translate) }}
        </button>
      </div>
    </div>
  </div>
  }

  <!-- Group Modal -->
  @if (showGroupModal()) {
  <div class="modal-overlay" (click)="closeModal('group')">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ groupFormId() ? ('appConfig.modal.group.editTitle' | translate) : (('appConfig.modal.group.createPrefix' | translate) + ' "' + (selectedApp()?.name || '') + '"') }}</h2>
        <button class="btn-close" (click)="closeModal('group')">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>{{ 'appConfig.modal.group.groupKeyLabel' | translate }}</label>
          <input type="text" class="form-control" [value]="groupKey()" (input)="groupKey.set($any($event.target).value)"
            [disabled]="!!groupFormId()" [placeholder]="('appConfig.modal.group.groupKeyPlaceholder' | translate)">
          <small class="form-text">{{ 'appConfig.modal.group.groupKeyHelp' | translate }}</small>
        </div>

        <div class="form-group">
          <label>{{ 'appConfig.modal.group.groupNameLabel' | translate }}</label>
          <input type="text" class="form-control" [value]="groupName()"
            (input)="groupName.set($any($event.target).value)" [placeholder]="('appConfig.modal.group.groupNamePlaceholder' | translate)">
        </div>

        <div class="form-group">
          <label>{{ 'appConfig.modal.group.descriptionLabel' | translate }}</label>
          <textarea class="form-control" rows="3" [value]="groupDescription()"
            (input)="groupDescription.set($any($event.target).value)"
            [placeholder]="('appConfig.modal.group.descriptionPlaceholder' | translate)"></textarea>
        </div>



        <div class="form-group">
          <label>{{ 'appConfig.modal.group.displayOrderLabel' | translate }}</label>
          <input type="number" class="form-control" [value]="groupDisplayOrder()"
            (input)="groupDisplayOrder.set(+$any($event.target).value)" placeholder="0">
        </div>

        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" [checked]="groupActive()" (change)="groupActive.set(!groupActive())">
            <span>{{ 'appConfig.modal.group.activeLabel' | translate }}</span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal('group')">{{ 'common.cancel' | translate }}</button>
        <button class="btn btn-primary" (click)="saveGroup()" [disabled]="saving()">
          @if (saving()) {
          <span class="spinner-sm"></span>
          }
          {{ groupFormId() ? ('common.update' | translate) : ('common.create' | translate) }}
        </button>
      </div>
    </div>
  </div>
  }

  <!-- Delete Modal -->
  @if (showDeleteModal()) {
  <div class="modal-overlay" (click)="closeModal('delete')">
    <div class="modal-content modal-sm" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ 'appConfig.modal.delete.title' | translate }}</h2>
        <button class="btn-close" (click)="closeModal('delete')">×</button>
      </div>
      <div class="modal-body">
        <p>{{ 'appConfig.modal.delete.messagePrefix' | translate }} <strong>{{ deleteName() }}</strong>?</p>
        <p class="text-danger">{{ 'common.cannotUndo' | translate }}</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal('delete')">{{ 'common.cancel' | translate }}</button>
        <button class="btn btn-danger" (click)="deleteType() === 'config' ? deleteConfig() : deleteGroup()">
          {{ 'common.delete' | translate }}
        </button>
      </div>
    </div>
  </div>
  }

  <!-- Details Modal with Tabs -->
  @if (showDetailsModal() && selectedConfig()) {
  <div class="modal-overlay" (click)="closeModal('details')">
    <div class="modal-content modal-lg" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ selectedConfig()!.configName }}</h2>
        <button class="btn-close" (click)="closeModal('details')">×</button>
      </div>

      <div class="modal-tabs">
        <button class="modal-tab" [class.active]="activeTab() === 'details'" (click)="activeTab.set('details')">
          {{ 'appConfig.modal.tabs.details' | translate }}
        </button>
        <button class="modal-tab" [class.active]="activeTab() === 'versions'" (click)="activeTab.set('versions')">
          {{ 'appConfig.modal.tabs.versions' | translate }}
        </button>
        <button class="modal-tab" [class.active]="activeTab() === 'audit'" (click)="activeTab.set('audit')">
          {{ 'appConfig.modal.tabs.audit' | translate }}
        </button>
      </div>

      <div class="modal-body">
        @if (activeTab() === 'details') {
        <div class="details-content">
          <div class="detail-group">
            <label>Config Key</label>
            <div class="detail-value">{{ selectedConfig()!.configKey }}</div>
          </div>
          <div class="detail-group">
            <label>Type</label>
            <div class="detail-value">
              <span class="type-badge" [style.background-color]="getTypeColor(selectedConfig()!.configType)">
                {{ getTypeIcon(selectedConfig()!.configType) }} {{ selectedConfig()!.configType }}
              </span>
            </div>
          </div>
          <div class="detail-group">
            <label>Current Value</label>
            <div class="detail-value">{{ selectedConfig()!.configValue || '(not set)' }}</div>
          </div>
          <div class="detail-group">
            <label>Default Value</label>
            <div class="detail-value">{{ selectedConfig()!.defaultValue || '(not set)' }}</div>
          </div>
          <div class="detail-group">
            <label>App Name</label>
            <div class="detail-value">{{ selectedConfig()!.appName }}</div>
          </div>
          @if (selectedConfig()!.groupName) {
          <div class="detail-group">
            <label>Group</label>
            <div class="detail-value">{{ selectedConfig()!.groupName }}</div>
          </div>
          }
          <div class="detail-group">
            <label>Status</label>
            <div class="detail-value">
              <span class="status-badge" [class.active]="selectedConfig()!.active">
                {{ selectedConfig()!.active ? 'Active' : 'Inactive' }}
              </span>
              @if (selectedConfig()!.isPublic) {
              <span class="status-badge public">Public</span>
              }
              @if (selectedConfig()!.isRequired) {
              <span class="status-badge required">Required</span>
              }
            </div>
          </div>
          <div class="detail-group">
            <label>Version</label>
            <div class="detail-value">v{{ selectedConfig()!.version }}</div>
          </div>
          <div class="detail-group">
            <label>Created By</label>
            <div class="detail-value">{{ selectedConfig()!.createdBy }} on {{ selectedConfig()!.createdAt |
              date:'medium' }}</div>
          </div>
          <div class="detail-group">
            <label>Updated By</label>
            <div class="detail-value">{{ selectedConfig()!.updatedBy }} on {{ selectedConfig()!.updatedAt |
              date:'medium' }}</div>
          </div>
        </div>
        }

        @if (activeTab() === 'versions') {
        <div class="versions-content">
          @if (versions().length === 0) {
          <p class="text-muted">No version history available</p>
          }
          @for (version of versions(); track version.id) {
          <div class="version-item">
            <div class="version-header">
              <div class="version-info">
                <span class="version-number">Version {{ version.version }}</span>
                <span class="version-type" [class]="version.changeType.toLowerCase()">
                  {{ version.changeType }}
                </span>
              </div>
              @if (version.version !== selectedConfig()!.version) {
              <button class="btn btn-sm btn-secondary" (click)="restoreVersion(version.id)">
                Restore
              </button>
              }
            </div>
            <div class="version-details">
              <p><strong>Value:</strong> {{ version.configValue || '(not set)' }}</p>
              <p><strong>Changed by:</strong> {{ version.changedBy }}</p>
              <p><strong>Changed at:</strong> {{ version.changedAt | date:'medium' }}</p>
              @if (version.changeDescription) {
              <p><strong>Description:</strong> {{ version.changeDescription }}</p>
              }
            </div>
          </div>
          }
        </div>
        }

        @if (activeTab() === 'audit') {
        <div class="audit-content">
          @if (auditLogs().length === 0) {
          <p class="text-muted">No audit log available</p>
          }
          @for (audit of auditLogs(); track audit.id) {
          <div class="audit-item">
            <div class="audit-icon" [class]="audit.action.toLowerCase()">
              @if (audit.action === 'CREATE') {
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
                  clip-rule="evenodd" />
              </svg>
              } @else if (audit.action === 'UPDATE') {
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                <path
                  d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
              </svg>
              } @else if (audit.action === 'DELETE') {
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
                  clip-rule="evenodd" />
              </svg>
              } @else {
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                <path fill-rule="evenodd"
                  d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"
                  clip-rule="evenodd" />
              </svg>
              }
            </div>
            <div class="audit-details">
              <div class="audit-action">{{ audit.action }}</div>
              <div class="audit-user">{{ audit.userEmail || 'System' }}</div>
              <div class="audit-time">{{ audit.timestamp | date:'medium' }}</div>
              @if (audit.oldValue || audit.newValue) {
              <div class="audit-changes">
                @if (audit.oldValue) {
                <div><strong>Old:</strong> {{ audit.oldValue }}</div>
                }
                @if (audit.newValue) {
                <div><strong>New:</strong> {{ audit.newValue }}</div>
                }
              </div>
              }
            </div>
          </div>
          }
        </div>
        }
      </div>
    </div>
  </div>
  }
  </div> <!-- End main content wrapper -->
</div>
